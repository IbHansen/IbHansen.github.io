

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>7. A simulation that targets a specific outcome &#8212; The World Bank&#39;s MFMod Framework in Python with Modelflow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"0b45441d7bac46208e1aac6a76ba0e18": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "22cb75da4d594f349e2ab4c8c7de4e83": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "28239a6c89904cd88ca8ba17f2a67397": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a690b344f5ef49f4a21f89cd2e1bef70", "placeholder": "\u200b", "style": "IPY_MODEL_49d1a494f4884bac92a69a603d26a657", "tabbable": null, "tooltip": null, "value": " 77/77"}}, "2ce2f7b5c46f44f2a90ef925049b0f6c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_baaa88baafdb4f189b16e01a0607fb65", "IPY_MODEL_800ad254333c4b99b166c8542e2cff48", "IPY_MODEL_e4cd9d142cca4dafa79faebd2fc3f1d6"], "layout": "IPY_MODEL_f049d136023e421e8fe7d4a6429580f3", "tabbable": null, "tooltip": null}}, "2f16860cc2ed4a18aadc063842abc83d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "37738cc00b874a2e970b6462e134be2f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3a63cb934ac949038047637ba60eaa48": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "49d1a494f4884bac92a69a603d26a657": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "581d845f5f9843b1b0139ccc7849e924": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "67b1f1ec12c2448eb830b654e3cd3a20": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6ccc66a0828c4c4e96e2055e2945262d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "768d8acfd7464741a5d385205c43b810": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_fc5bb133611843aa80303a96107d904f", "IPY_MODEL_ae7731e62628401b94d1616e90c0071c", "IPY_MODEL_fec5f7284966414cb96bf7c0c6a4d923"], "layout": "IPY_MODEL_899bb4da93bc43a5986a1bb4e3c4d5cd", "tabbable": null, "tooltip": null}}, "800ad254333c4b99b166c8542e2cff48": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6ccc66a0828c4c4e96e2055e2945262d", "max": 77.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_9968bb5adf3b4a30877e80dc45eb545a", "tabbable": null, "tooltip": null, "value": 77.0}}, "899bb4da93bc43a5986a1bb4e3c4d5cd": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "92a37268eea1418aa6e14affa72563f6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a530157cd4e34d5da4e16d9061bc8823", "placeholder": "\u200b", "style": "IPY_MODEL_2f16860cc2ed4a18aadc063842abc83d", "tabbable": null, "tooltip": null, "value": "Finding instruments : 100%"}}, "9968bb5adf3b4a30877e80dc45eb545a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "9b13ab23ddd641e49ad54c0d5eb36377": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9f12fa375793418f818dffd746d0b858": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a530157cd4e34d5da4e16d9061bc8823": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a5a1ea899c994087bb526ff55e823680": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a690b344f5ef49f4a21f89cd2e1bef70": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ae7731e62628401b94d1616e90c0071c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_37738cc00b874a2e970b6462e134be2f", "max": 77.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_c12edb64fa184d5eb8ebafc776261ab4", "tabbable": null, "tooltip": null, "value": 77.0}}, "b0d87712c1ec4c3894aa14153cc40d2a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b2d04571ed8e4f129972402763b3e321": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_92a37268eea1418aa6e14affa72563f6", "IPY_MODEL_cdb6ca74b71a492db98e21a2d8505c1b", "IPY_MODEL_28239a6c89904cd88ca8ba17f2a67397"], "layout": "IPY_MODEL_0b45441d7bac46208e1aac6a76ba0e18", "tabbable": null, "tooltip": null}}, "b92da80615b6414d91e6204dbe90f8d3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "baaa88baafdb4f189b16e01a0607fb65": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b0d87712c1ec4c3894aa14153cc40d2a", "placeholder": "\u200b", "style": "IPY_MODEL_3a63cb934ac949038047637ba60eaa48", "tabbable": null, "tooltip": null, "value": "Finding instruments : 100%"}}, "c12edb64fa184d5eb8ebafc776261ab4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "cdb6ca74b71a492db98e21a2d8505c1b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_22cb75da4d594f349e2ab4c8c7de4e83", "max": 77.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_fc03df97697c448ab51333ffd0d6e030", "tabbable": null, "tooltip": null, "value": 77.0}}, "e4cd9d142cca4dafa79faebd2fc3f1d6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_67b1f1ec12c2448eb830b654e3cd3a20", "placeholder": "\u200b", "style": "IPY_MODEL_b92da80615b6414d91e6204dbe90f8d3", "tabbable": null, "tooltip": null, "value": " 77/77"}}, "f049d136023e421e8fe7d4a6429580f3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fc03df97697c448ab51333ffd0d6e030": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "fc5bb133611843aa80303a96107d904f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9f12fa375793418f818dffd746d0b858", "placeholder": "\u200b", "style": "IPY_MODEL_a5a1ea899c994087bb526ff55e823680", "tabbable": null, "tooltip": null, "value": "Finding instruments : 100%"}}, "fec5f7284966414cb96bf7c0c6a4d923": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9b13ab23ddd641e49ad54c0d5eb36377", "placeholder": "\u200b", "style": "IPY_MODEL_581d845f5f9843b1b0139ccc7849e924", "tabbable": null, "tooltip": null, "value": " 77/77"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/07_MoreFeatures/Targeting';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1. Model analytics" href="../06_ModelAnalytics/ModelStructure.html" />
    <link rel="prev" title="6. More complex scenarios" href="../05_WBModels/MoreComplexScenarios.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../introduction.html">
  
  
  
  
  
    <p class="title logo__title">The World Bank's MFMod Framework in Python with Modelflow</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction.html">
                    Foreword
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">The World Bank's MFMod Framework and Modelflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_Introduction/Introduction.html">1. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02_MacrostructuralModels/MacroStructuralModels.html">2. Macrostructural models</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_MacrostructuralModels/MFModAndModelFlow.html">2.2. Modelflow and the MFMod models of the World Bank</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_Installation/InstallingModelFlow.html">3. Installation of Modelflow</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_Installation/InstallingPython.html">3.1. Installation of Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_Installation/InstallingModelFlowpackage.html">3.2. Installation of  <code class="docutils literal notranslate"><span class="pre">Modelflow</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_Installation/UpdateModelFlow.html">3.3. Updating Modelflow</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Some python essentials for using World Bank models with modelflow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04_PythonEssentials/Intro_Jupyter_notebook.html">1. Introduction to  Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_PythonEssentials/PythonBasics.html">2. Some Python basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_PythonEssentials/PandasDataFrames.html">3. Introduction to Pandas, Pandas Series and Pandas dataframes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_PythonEssentials/UpdateCommand.html">4. Modelflow extensions to pandas</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_PythonEssentials/mfcalc.html">4.6. <code class="docutils literal notranslate"><span class="pre">.mfcalc()</span></code> an extension of standard Pandas</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Using modelflow with World Bank models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../05_WBModels/UsingWBModels.html">1. Using <code class="docutils literal notranslate"><span class="pre">modelflow</span></code> with World Bank models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_WBModels/LoadingWBModel.html">2. Working with PakMod under modelflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_WBModels/WorkingwWBModels.html">3. Working with PakMod under modelflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_WBModels/ScenarioAnalysis.html">4. Scenario analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_WBModels/ReportWriting.html">5. Report writing and scenario results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_WBModels/MoreComplexScenarios.html">6. More complex scenarios</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. A simulation that targets a specific outcome</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Analytics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../06_ModelAnalytics/ModelStructure.html">1. Model analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_ModelAnalytics/AttributionSomeFeatures.html">2. Analyzing the impact of a shock</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Technical how tos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GettingHelp.html">1. Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelFlowCommandReference.html">2. Modelflow methods reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Reference.html">Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/IbHansen/modelflow-manual/blob/AndrewEdits/papers/mfbook/content/07_MoreFeatures/Targeting.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/IbHansen/modelflow-manual" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/07_MoreFeatures/Targeting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>A simulation that targets a specific outcome</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-the-work-space">7.1. Preparing the work space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-a-model-data-and-descriptions">7.2. Load a  model, data and descriptions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-the-model-to-create-a-baseline">7.3. Solve the model to create a baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-co2-emission-a-very-simple-example">7.4. Target CO2 emission - a  very simple example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-targets">7.4.1. Define targets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-instruments">7.4.2. Define instruments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-instruments">7.4.3. Find the instruments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display-result">7.4.4. Display result</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#targeting-carbon-emissions-in-a-budget-neutral-manner">7.5. Targeting carbon emissions in a budget neutral manner</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-co2-emission-and-government-deficit-by-adjusting-carbon-tax-and-government-expenditure">7.6. Target CO2 emission and government deficit by adjusting carbon tax and government expenditure.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-target-trajectory-for-co2-emission">7.6.1. Define target trajectory for CO2 emission.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dataframe-with-the-target-emission">7.6.2. Create a dataframe with the target emission</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-target-for-government-deficit">7.6.3. Create target for government deficit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.7. Define instruments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-solve-the-problem">7.8. Now solve the problem:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-charts-of-emission-deficit-and-target-variables">7.8.1. Make charts of emission, deficit and target variables.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weighting-the-instruments">7.9. Weighting the instruments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#targeting-background">7.10. Targeting background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-the-target-input-to-get-a-result">7.11. Tuning the target input to get a result</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse">7.11.1. impulse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinearity">7.11.2. Nonlinearity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence">7.11.3. Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-number-of-iterations">7.11.4. Maximum number of iterations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-instruments">7.12. Defining Instruments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-information-targeting-class-instance">7.13. Advanced information -  targeting class instance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#instruments-a-list-if-instruments">7.13.1. <code class="docutils literal notranslate"><span class="pre">.instruments</span></code> a list if instruments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jac-the-jacobi-matrix">7.13.2. <code class="docutils literal notranslate"><span class="pre">.jac</span></code> The Jacobi matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inv-the-inverted-jacobi-matrix">7.13.3. <code class="docutils literal notranslate"><span class="pre">.inv</span></code> The inverted Jacobi matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence-convergence-criteria">7.13.4. <code class="docutils literal notranslate"><span class="pre">.convergence</span></code> Convergence criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#targets-the-targets">7.13.5. <code class="docutils literal notranslate"><span class="pre">.targets</span></code> The targets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jacob-caculate-the-jacobi-matrix">7.14. .jacob() Caculate the jacobi matrix</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a-simulation-that-targets-a-specific-outcome">
<h1><span class="section-number">7. </span>A simulation that targets a specific outcome<a class="headerlink" href="#a-simulation-that-targets-a-specific-outcome" title="Permalink to this headline">#</a></h1>
<p>In normal model use, the trajectory of the exogenous variables determine the trajectory of the endogenous (left hand side) variables. However, sometimes  it can be useful to target a trajectory of some endogenous variables by calculating a trajectory of exogenous variables. That is the exogenous variables are a function of the endogenous variables.</p>
<p>A simple example might be where a policy maker wanted to know what level of Carbon Tax implemented in a budget neutral fashion would be needed to achieve a specific level of emissions.  As specified, the analytical question is to achieve two targets:</p>
<ol class="arabic simple">
<li><p>A specific <span class="math notranslate nohighlight">\(CO^2\)</span> emissions trajectory</p></li>
<li><p>An unchanged fiscal deficit</p></li>
</ol>
<p><strong>Targeting</strong> in <code class="docutils literal notranslate"><span class="pre">Modelflow</span></code> requires that there be <strong>at least as many instruments as there are targets</strong>. So in the above example at least two instruments would be required.</p>
<p>The instrument to achieve the emissions could be a Carbon tax (applied uniformly on emissions from coal, gas and crude oil).  The instrument to achieve an unchanged fiscal deficit, could be government spending or another from of revenue, say taxes on labor.</p>
<p>To illustrate a climate aware model for Pakistan <span id="id1"><a class="reference internal" href="../../Reference.html#id14" title="Andrew Burns, Charl Jooste, and Gregor Schwerhoff. Climate Modeling for Macroeconomic Policy : A Case Study for Pakistan. Number 9780 in Policy Research Working Papers. World Bank, Washington, DC, 2021. URL: https://openknowledge.worldbank.org/bitstream/handle/10986/36307/Climate-Modeling-for-Macroeconomic-Policy-A-Case-Study-for-Pakistan.pdf?sequence=1&amp;isAllowed=y.">Burns <em>et al.</em></a></span> is used.</p>
<p>To run the targetting simulation, the following main steps must be undertaken</p>
<ol class="arabic simple">
<li><p>Load a model and data</p></li>
<li><p>Create an baseline</p></li>
<li><p>Define instrument variables (one instrument can consist of several variables).</p></li>
<li><p>Define a dataframe with the trajectory of the target variables.</p></li>
<li><p>Solve the problem by using the <code class="docutils literal notranslate"><span class="pre">.invert</span></code> method.</p></li>
<li><p>Visualize the results</p></li>
</ol>
<section id="preparing-the-work-space">
<span id="index-0"></span><h2><span class="section-number">7.1. </span>Preparing the work space<a class="headerlink" href="#preparing-the-work-space" title="Permalink to this headline">#</a></h2>
<p>As always before running a simulation, the various python classes that will be used must be imported.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDDEN in jupyterbook </span>
<span class="c1">#This is code to manage dependencies if the notebook is executed in the google colab cloud service</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
  <span class="kn">import</span> <span class="nn">os</span>
  <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;apt -qqq install graphviz&#39;</span><span class="p">)</span>
  <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;pip -qqq install ModelFlowIb ipysheet  --no-dependencies &#39;</span><span class="p">)</span>
  <span class="n">incolab</span> <span class="o">=</span> <span class="kc">True</span>  
<span class="k">else</span><span class="p">:</span>
  <span class="n">incolab</span> <span class="o">=</span> <span class="kc">False</span> 

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">modelclass</span> <span class="kn">import</span> <span class="n">model</span> 

<span class="n">model</span><span class="o">.</span><span class="n">widescreen</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">scroll_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <style>
            div#notebook-container    { width: 95%; }
            div#menubar-container     { width: 65%; }
            div#maintoolbar-container { width: 99%; }
        </style>
        </div></div>
</div>
</section>
<section id="load-a-model-data-and-descriptions">
<h2><span class="section-number">7.2. </span>Load a  model, data and descriptions<a class="headerlink" href="#load-a-model-data-and-descriptions" title="Permalink to this headline">#</a></h2>
<p>The file <code class="docutils literal notranslate"><span class="pre">pak.pcim</span></code> contains a dump of model equations, dataframe, simulation options and variable descriptions. The file has been created when onboarding the model. The onboarding process is described <span class="xref myst">here.</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpak</span><span class="p">,</span><span class="n">initial</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">modelload</span><span class="p">(</span><span class="s1">&#39;../models/pak.pcim&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>file read:  C:\modelflow manual\papers\mfbook\content\models\pak.pcim
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-the-model-to-create-a-baseline">
<h2><span class="section-number">7.3. </span>Solve the model to create a baseline<a class="headerlink" href="#solve-the-model-to-create-a-baseline" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baseline</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">(</span><span class="n">initial</span><span class="p">,</span><span class="mi">2022</span><span class="p">,</span><span class="mi">2100</span><span class="p">,</span><span class="n">alfa</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ljit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpak</span><span class="o">.</span><span class="n">basedf</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<span class="target" id="index-1"></span><span class="target" id="index-2"></span><p id="index-3">Note in this example the <code class="docutils literal notranslate"><span class="pre">ljit</span></code> option is set to True. This instructs the solver to <em>compile</em> the model. Model compilation takes time. When a model will be solved multuiple times, the additional time cost of compiling model, can be made up because the compiled model almost always solves much more quickly than the  uncompiled model.</p>
</section>
<section id="target-co2-emission-a-very-simple-example">
<h2><span class="section-number">7.4. </span>Target CO2 emission - a  very simple example<a class="headerlink" href="#target-co2-emission-a-very-simple-example" title="Permalink to this headline">#</a></h2>
<p>The first and very simple example only the emission is targeted - in this case - an just to keep the example simple - the
target is to keep the a yearly growth of emission rate at 1 percent.</p>
<section id="define-targets">
<h3><span class="section-number">7.4.1. </span>Define targets<a class="headerlink" href="#define-targets" title="Permalink to this headline">#</a></h3>
<span class="target" id="index-4"></span><div class="cell docutils container" id="index-5">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create dataframe with only the target variable </span>
<span class="n">target_before_simple</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2024</span><span class="p">:</span><span class="mi">2100</span><span class="p">,[</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span><span class="p">]]</span>    

<span class="c1"># create a target dataframe with a projection of the target variable </span>
<span class="n">target_simple</span> <span class="o">=</span> <span class="n">target_before_simple</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;2025 2100&gt; PAKCCEMISCO2TKN =growth 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span class="target" id="index-6"></span></section>
<section id="define-instruments">
<span id="index-7"></span><h3><span class="section-number">7.4.2. </span>Define instruments<a class="headerlink" href="#define-instruments" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">instruments_simple</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;PAKGGREVCO2CER&#39;</span><span class="p">,</span><span class="s1">&#39;PAKGGREVCO2GER&#39;</span><span class="p">,</span> <span class="s1">&#39;PAKGGREVCO2OER&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<span class="target" id="index-8"></span></section>
<section id="find-the-instruments">
<span id="index-9"></span><h3><span class="section-number">7.4.3. </span>Find the instruments<a class="headerlink" href="#find-the-instruments" title="Permalink to this headline">#</a></h3>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">mpak</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span>                  <span class="c1"># Invert calls the target instrument device                   </span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">target_simple</span><span class="p">,</span>                   
                <span class="n">instruments</span><span class="o">=</span><span class="n">instruments_simple</span><span class="p">,</span>
                
                <span class="n">DefaultImpuls</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>      <span class="c1"># The default impulse instrument variables </span>
                <span class="n">defaultconv</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">,</span>    <span class="c1"># Convergergence criteria for targets</span>
                <span class="n">varimpulse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>      <span class="c1"># Changes in instruments in each iteration are carried over to the future</span>
                <span class="n">nonlin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>              <span class="c1"># If no convergence in 15 iteration recalculate jacobi </span>
                <span class="n">silent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>              <span class="c1"># Don&#39;t show iteration output (try 1 for showing)</span>
                <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span>
                <span class="n">progressbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="display-result">
<h3><span class="section-number">7.4.4. </span>Display result<a class="headerlink" href="#display-result" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">mpak</span><span class="o">.</span><span class="n">set_smpl</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2100</span><span class="p">):</span>    <span class="c1"># change if you want another  timeframe </span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pakistan CO2 emission&#39;</span><span class="p">)</span> 
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGREVCO2CER&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan, taxes for coal, oil and gas are the same&#39;</span><span class="p">);</span> 
    
<span class="k">with</span> <span class="n">mpak</span><span class="o">.</span><span class="n">set_smpl</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2040</span><span class="p">):</span>    <span class="c1"># for the near future. </span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGREVCO2CER&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan, taxes for coal, oil and gas, near future&#39;</span><span class="p">);</span>     
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d8e98f90e7e10f39d3431e5138ddee70356c3cd22ccd97cdf9b9a1ab249c3572.png" src="../../_images/d8e98f90e7e10f39d3431e5138ddee70356c3cd22ccd97cdf9b9a1ab249c3572.png" />
<img alt="../../_images/571f037f9dd55ce999c1fd59d200f0a898e380e02d9a778b656bffa5fc54f7d4.png" src="../../_images/571f037f9dd55ce999c1fd59d200f0a898e380e02d9a778b656bffa5fc54f7d4.png" />
<img alt="../../_images/ecbb18f3d04f5ded03c8dbad34946228ad0964219d4d04ead384656864ad8f4d.png" src="../../_images/ecbb18f3d04f5ded03c8dbad34946228ad0964219d4d04ead384656864ad8f4d.png" />
</div>
</div>
</section>
</section>
<section id="targeting-carbon-emissions-in-a-budget-neutral-manner">
<h2><span class="section-number">7.5. </span>Targeting carbon emissions in a budget neutral manner<a class="headerlink" href="#targeting-carbon-emissions-in-a-budget-neutral-manner" title="Permalink to this headline">#</a></h2>
<p>In the example below the two instruments are the:</p>
<ol class="arabic simple">
<li><p>Carbon emission tax, which is covered by 3 variables</p></li>
<li><p>Government capital expenditure</p></li>
</ol>
</section>
<section id="target-co2-emission-and-government-deficit-by-adjusting-carbon-tax-and-government-expenditure">
<h2><span class="section-number">7.6. </span>Target CO2 emission and government deficit by adjusting carbon tax and government expenditure.<a class="headerlink" href="#target-co2-emission-and-government-deficit-by-adjusting-carbon-tax-and-government-expenditure" title="Permalink to this headline">#</a></h2>
<p>This example  has two targets.</p>
<ol class="arabic simple">
<li><p>To reduce carbon emissions by 40% by 2050 and then hold them at that level. The instrument to be employed will be a Carbon tax.</p></li>
<li><p>To keep the government budget remains unchanged.</p></li>
</ol>
<p>The instrument to be used is:</p>
<ol class="arabic simple">
<li><p>Carbon tax which is covered by 3 variables</p></li>
<li><p>Government spending on goods and services, implying that revenues from the Carbon Taxes will be used to increase government services.</p></li>
</ol>
<p>Both instruments impact both targets.</p>
<p><span id="id2"><a class="reference internal" href="../../Reference.html#id14" title="Andrew Burns, Charl Jooste, and Gregor Schwerhoff. Climate Modeling for Macroeconomic Policy : A Case Study for Pakistan. Number 9780 in Policy Research Working Papers. World Bank, Washington, DC, 2021. URL: https://openknowledge.worldbank.org/bitstream/handle/10986/36307/Climate-Modeling-for-Macroeconomic-Policy-A-Case-Study-for-Pakistan.pdf?sequence=1&amp;isAllowed=y.">Burns <em>et al.</em></a></span> using the same model explores the macroeconomic consequences implications of alternative uses of the revenues from the Carbon Tax.</p>
<section id="define-target-trajectory-for-co2-emission">
<h3><span class="section-number">7.6.1. </span>Define target trajectory for CO2 emission.<a class="headerlink" href="#define-target-trajectory-for-co2-emission" title="Permalink to this headline">#</a></h3>
<p>The objective is to reduce Carbon emissions by 75% (as compared with the baseline) by the year 2050 and hold them constant in level terms afterwards.</p>
<div class="tip admonition">
<p class="admonition-title">Experiment with the result </p>
<p>By changing the two variables below the user can experiment with the impact of different emission targets and different years in which the target
should be fulfilled</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reduction_percent</span> <span class="o">=</span> <span class="mi">40</span>  <span class="c1"># Input the desired reduction in percent. </span>
<span class="n">achieved_by</span>       <span class="o">=</span> <span class="mi">2050</span>
</pre></div>
</div>
</div>
</div>
<p>To implement this, one must:</p>
<ol class="arabic simple">
<li><p>Calculate the target emission in the target  year (achived_by) = <span class="math notranslate nohighlight">\(PAKCCEMISCO2TKN_{achieved\_by} (1-reduction\_percent/100)\)</span></p></li>
<li><p>Calculate the yearly growth rate of the target variable needed to reach that level=<br>
<span class="math notranslate nohighlight">\(\dfrac{Target_{achieved\_by}}{PAKCCEMISCO2TKN_{2024}}^{\dfrac{1}{achieved\_by-2024}}-1\)</span></p></li>
<li><p>Calculate target values for emission in each year and then hold them constant from target year  through 2100</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bau_achieved_by</span>     <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">achieved_by</span><span class="p">,</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span><span class="p">]</span>
<span class="n">bau_2024</span>            <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2024</span><span class="p">,</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span><span class="p">]</span>

<span class="n">target_achieved_by</span>  <span class="o">=</span> <span class="n">bau_achieved_by</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">reduction_percent</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>


<span class="n">target_growth_rate</span>  <span class="o">=</span> <span class="p">(</span><span class="n">target_achieved_by</span><span class="o">/</span><span class="n">bau_2024</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">achieved_by</span><span class="o">-</span><span class="mi">2024</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">bau_growth_rate</span>     <span class="o">=</span> <span class="p">(</span><span class="n">bau_achieved_by</span><span class="o">/</span><span class="n">bau_2024</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">achieved_by</span><span class="o">-</span><span class="mi">2024</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Business as usual Emission value in </span><span class="si">{</span><span class="n">achieved_by</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">bau_achieved_by</span><span class="si">:</span><span class="s2">13,.0f</span><span class="si">}</span><span class="s2"> tons&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target  Emission value in </span><span class="si">{</span><span class="n">achieved_by</span><span class="si">}</span><span class="s2">           : </span><span class="si">{</span><span class="n">target_achieved_by</span><span class="si">:</span><span class="s2">13,.0f</span><span class="si">}</span><span class="s2"> tons&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Business as usual growth rate in percent : </span><span class="si">{</span><span class="n">bau_growth_rate</span><span class="si">:</span><span class="s2">13,.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target growth rate in percent            : </span><span class="si">{</span><span class="n">target_growth_rate</span><span class="si">:</span><span class="s2">13,.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Business as usual Emission value in 2050 :   439,930,556 tons
Target  Emission value in 2050           :   263,958,334 tons
Business as usual growth rate in percent :          2.5%
Target growth rate in percent            :          0.5%
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-dataframe-with-the-target-emission">
<h3><span class="section-number">7.6.2. </span>Create a dataframe with the target emission<a class="headerlink" href="#create-a-dataframe-with-the-target-emission" title="Permalink to this headline">#</a></h3>
<p>Now a dataframe can be created using the growth rate for the target variable calculated above.</p>
<p>The dataframe should only contain columns for the target variables, at this stage just one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_before</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2024</span><span class="p">:,[</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span><span class="p">]]</span>     <span class="c1"># Create dataframe with only the target variable </span>
<span class="c1"># create a target dataframe with a projection of the target variable </span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target_before</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;2025 </span><span class="si">{</span><span class="n">achieved_by</span><span class="si">}</span><span class="s1">&gt; PAKCCEMISCO2TKN =growth </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">target_growth_rate</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">upd</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="mi">2100</span><span class="p">,</span><span class="n">achieved_by</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="mi">2100</span><span class="si">}</span><span class="s1">&gt; PAKCCEMISCO2TKN = </span><span class="si">{</span><span class="n">target_achieved_by</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#target.loc[:2055]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-target-for-government-deficit">
<h3><span class="section-number">7.6.3. </span>Create target for government deficit<a class="headerlink" href="#create-target-for-government-deficit" title="Permalink to this headline">#</a></h3>
<p>This is done simply by taking the values in the baseline for the relevant years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;PAKGGBALOVRLCN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">baseline</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2022</span><span class="p">:</span><span class="mi">2100</span><span class="p">,</span><span class="s1">&#39;PAKGGBALOVRLCN&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Target values for CO2 Emission and deficit&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5a3dc72f779b323fc97b13c3928a979e0523ef14d5cc172ec208e152afcf296b.png" src="../../_images/5a3dc72f779b323fc97b13c3928a979e0523ef14d5cc172ec208e152afcf296b.png" />
</div>
</div>
</section>
</section>
<section id="id3">
<h2><span class="section-number">7.7. </span>Define instruments<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>The instruments to be used are the <strong>carbon tax</strong> and <strong>government spending on goods and services</strong>.  To find the mnemonics for these variables a search is done over the descriptions of the variables, first over the carbon tax:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpak</span><span class="p">[</span><span class="s1">&#39;!*Carbon*&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">des</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PAKGGREVCO2CER : Carbon tax on coal (USD/t)
PAKGGREVCO2GER : Carbon tax on gas (USD/t)
PAKGGREVCO2OER : Carbon tax on oil (USD/t)
</pre></div>
</div>
</div>
</div>
<p>A separate search is done to identify the government spending variable to be used as an instrument. It makes sense to use a variable which has a fairly direct impact on the government deficit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpak</span><span class="p">[</span><span class="s1">&#39;!*expenditure*on*capital*&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">des</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PAKGGEXPCAPTCN        : General government expenditure on capital expenditure (millions lcu)
PAKGGEXPCAPTCN_A      : Add factor:General government expenditure on capital expenditure (millions lcu)
PAKGGEXPCAPTCN_D      : Fix dummy:General government expenditure on capital expenditure (millions lcu)
PAKGGEXPCAPTCN_FITTED : Fitted  value:General government expenditure on capital expenditure (millions lcu)
PAKGGEXPCAPTCN_X      : Fix value:General government expenditure on capital expenditure (millions lcu)
</pre></div>
</div>
</div>
</div>
<p>For the purposes of this experiment the <code class="docutils literal notranslate"><span class="pre">PAKGGEXPGNFSCN_A</span></code> variable (the add-factor for the government spending on goods and services equation) is selected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">instruments</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;PAKGGREVCO2CER&#39;</span><span class="p">,</span><span class="s1">&#39;PAKGGREVCO2GER&#39;</span><span class="p">,</span> <span class="s1">&#39;PAKGGREVCO2OER&#39;</span><span class="p">],</span>
               <span class="s1">&#39;PAKGGEXPGNFSCN_A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>In total there are two instruments and two targets, which satisfies the constraint that there must be <strong>exactly  as many instruments as targets</strong>.</p>
</section>
<section id="now-solve-the-problem">
<h2><span class="section-number">7.8. </span>Now solve the problem:<a class="headerlink" href="#now-solve-the-problem" title="Permalink to this headline">#</a></h2>
<p>Now we have a dataframe with target values and a list of instrument variables. We are ready to solve the problem.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mpak</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span>                  <span class="c1"># Invert calls the target instrument device                   </span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:</span> <span class="p">],</span>                   
                <span class="n">instruments</span><span class="o">=</span><span class="n">instruments</span><span class="p">,</span>
                <span class="n">DefaultImpuls</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>              <span class="c1"># The default impulse instrument variables </span>
                <span class="n">defaultconv</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">,</span>              <span class="c1"># Convergergence criteria for targets</span>
                <span class="n">varimpulse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>             <span class="c1"># Changes in instruments in each iteration are carried over to the future</span>
                <span class="n">nonlin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>                    <span class="c1"># If no convergence in 15 iteration recalculate jacobi </span>
                <span class="n">silent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                     <span class="c1"># Don&#39;t show iteration output (try 1 for showing)</span>
                <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">2590</span><span class="p">,</span>
                <span class="n">progressbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="make-charts-of-emission-deficit-and-target-variables">
<h3><span class="section-number">7.8.1. </span>Make charts of emission, deficit and target variables.<a class="headerlink" href="#make-charts-of-emission-deficit-and-target-variables" title="Permalink to this headline">#</a></h3>
<p>Decorate the emission chart with a line showing the target.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">mpak</span><span class="o">.</span><span class="n">set_smpl</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2100</span><span class="p">):</span>    <span class="c1"># change if you want another  timeframe </span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pakistan CO2 emission&#39;</span><span class="p">)</span> 
    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span> <span class="n">target_achieved_by</span><span class="p">,</span>
                                <span class="n">xmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                  <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
                                  <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;BAU </span><span class="si">{</span><span class="n">achieved_by</span><span class="si">}</span><span class="s1"> reduced by </span><span class="si">{</span><span class="n">reduction_percent</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2050</span><span class="p">,</span><span class="n">target_achieved_by</span> <span class="p">))</span>
    <span class="n">fig0</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGBALOVRLCN&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan&#39;</span><span class="p">);</span> 
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGREVCO2CER&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan&#39;</span><span class="p">);</span> 
    <span class="n">fig3</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGEXPGNFSCN_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan&#39;</span><span class="p">);</span> 
    <span class="n">fig3</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGEXPGNFSCN&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan&#39;</span><span class="p">);</span> 
    <span class="n">fig4</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKGGEXPCAPTCN&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Pakistan&#39;</span><span class="p">);</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f69bd24b6a5e55cb16285b718ac8489d2685a37342ef7a7e3e8c820f297dea68.png" src="../../_images/f69bd24b6a5e55cb16285b718ac8489d2685a37342ef7a7e3e8c820f297dea68.png" />
<img alt="../../_images/27cbdeec5e07a2b8590d89fd14d59fd71fc808e59dd193cf3078a4a29a8ac501.png" src="../../_images/27cbdeec5e07a2b8590d89fd14d59fd71fc808e59dd193cf3078a4a29a8ac501.png" />
<img alt="../../_images/4fd1b7b9be285f3c2eab8d9ee0872076cca1b2e1ee65a9fd798d81a9e978d472.png" src="../../_images/4fd1b7b9be285f3c2eab8d9ee0872076cca1b2e1ee65a9fd798d81a9e978d472.png" />
<img alt="../../_images/f4a4d6df7a4ec70736b45074d25a7e6ffdf30dc291497b0ba5a49b5e058a98ef.png" src="../../_images/f4a4d6df7a4ec70736b45074d25a7e6ffdf30dc291497b0ba5a49b5e058a98ef.png" />
<img alt="../../_images/6cc57a87c662549ac78f0953b309378e5ccdaf598ac3692ebcfa13f06ecacd43.png" src="../../_images/6cc57a87c662549ac78f0953b309378e5ccdaf598ac3692ebcfa13f06ecacd43.png" />
<img alt="../../_images/7ef42ae28a66c850652ac9551ce976ddb6068e0c3525e3dbc66c027525a312f8.png" src="../../_images/7ef42ae28a66c850652ac9551ce976ddb6068e0c3525e3dbc66c027525a312f8.png" />
</div>
</div>
<p>So the carbon taxes and expenditure nessecary to acheive the targets was calculated.</p>
</section>
</section>
<section id="weighting-the-instruments">
<h2><span class="section-number">7.9. </span>Weighting the instruments<a class="headerlink" href="#weighting-the-instruments" title="Permalink to this headline">#</a></h2>
<p>When using multiple instruments for a single target, the modeler may  want to privilege changes in one instrument over another by specifying weights to attach to each.  In the example below, specific weights are attached to the instruments instructing the solver to place twice as much emphasis on adjusting the carbon tax on coal emissions (as compared with the other two carbon taxes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_instruments</span> <span class="o">=</span><span class="p">[[(</span><span class="s1">&#39;PAKGGREVCO2CER&#39;</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;PAKGGREVCO2GER&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
                   <span class="p">(</span><span class="s1">&#39;PAKGGREVCO2OER&#39;</span><span class="p">,</span><span class="mi">25</span><span class="p">)],</span>
                 <span class="s1">&#39;PAKGGEXPGNFSCN_A&#39;</span><span class="p">]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">mpak</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span>                  <span class="c1"># Invert calls the target instrument device                   </span>
                <span class="n">targets</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,:</span> <span class="p">],</span>                   
                <span class="n">instruments</span><span class="o">=</span><span class="n">new_instruments</span><span class="p">,</span>
                <span class="n">DefaultImpuls</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>              <span class="c1"># The default impulse instrument variables </span>
                <span class="n">defaultconv</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">,</span>              <span class="c1"># Convergergence criteria for targets</span>
                <span class="n">varimpulse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>             <span class="c1"># Changes in instruments in each iteration are carried over to the future</span>
                <span class="n">nonlin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>                    <span class="c1"># If no convergence in 15 iteration recalculate jacobi </span>
                <span class="n">silent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                     <span class="c1"># Don&#39;t show iteration output (try 1 for showing)</span>
                <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">maxiter</span> <span class="o">=</span> <span class="mi">2590</span><span class="p">,</span>
                <span class="n">progressbar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "768d8acfd7464741a5d385205c43b810", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">mpak</span><span class="o">.</span><span class="n">set_smpl</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">2100</span><span class="p">):</span>    <span class="c1"># change if you want another  timeframe </span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PAKCCEMISCO2TKN&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">plot_alt</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pakistan CO2 emission&#39;</span><span class="p">)</span> 
    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span> <span class="n">target_achieved_by</span><span class="p">,</span>
                                <span class="n">xmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                  <span class="n">xmax</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
                                  <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;BAU </span><span class="si">{</span><span class="n">achieved_by</span><span class="si">}</span><span class="s1"> reduced by </span><span class="si">{</span><span class="n">reduction_percent</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2050</span><span class="p">,</span><span class="n">target_achieved_by</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/78b16990090f5c5b962369dddae7ce9a74ee65b7946d7ff20d7c74f60643962a.png" src="../../_images/78b16990090f5c5b962369dddae7ce9a74ee65b7946d7ff20d7c74f60643962a.png" />
</div>
</div>
<p>Below the level of the different tax rates the last 10 years are displayed. As wished the tax on coal is larger than the tax on gas and oil.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">mpak</span><span class="p">[</span><span class="s1">&#39;PAKGGREVCO2CER PAKGGREVCO2GER PAKGGREVCO2OER&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">()</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2090</span><span class="p">:</span><span class="mi">2100</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Carbon tax on coal (USD/t)</th>
      <th>Carbon tax on gas (USD/t)</th>
      <th>Carbon tax on oil (USD/t)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2090</th>
      <td>132726.144431</td>
      <td>66324.846251</td>
      <td>66357.136485</td>
    </tr>
    <tr>
      <th>2091</th>
      <td>148302.375552</td>
      <td>74112.961812</td>
      <td>74145.252045</td>
    </tr>
    <tr>
      <th>2092</th>
      <td>165678.190475</td>
      <td>82800.869273</td>
      <td>82833.159507</td>
    </tr>
    <tr>
      <th>2093</th>
      <td>185061.521260</td>
      <td>92492.534666</td>
      <td>92524.824899</td>
    </tr>
    <tr>
      <th>2094</th>
      <td>206682.713634</td>
      <td>103303.130853</td>
      <td>103335.421086</td>
    </tr>
    <tr>
      <th>2095</th>
      <td>230800.511120</td>
      <td>115362.029596</td>
      <td>115394.319829</td>
    </tr>
    <tr>
      <th>2096</th>
      <td>257701.532430</td>
      <td>128812.540251</td>
      <td>128844.830484</td>
    </tr>
    <tr>
      <th>2097</th>
      <td>287707.810227</td>
      <td>143815.679149</td>
      <td>143847.969383</td>
    </tr>
    <tr>
      <th>2098</th>
      <td>321176.056069</td>
      <td>160549.802070</td>
      <td>160582.092304</td>
    </tr>
    <tr>
      <th>2099</th>
      <td>358507.159236</td>
      <td>179215.353654</td>
      <td>179247.643887</td>
    </tr>
    <tr>
      <th>2100</th>
      <td>400145.119522</td>
      <td>200034.333796</td>
      <td>200066.624030</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="targeting-background">
<h2><span class="section-number">7.10. </span>Targeting background<a class="headerlink" href="#targeting-background" title="Permalink to this headline">#</a></h2>
<p>The concept of targets and instruments in economic modeling was introduced by <span id="id4">Tinbergen [<a class="reference internal" href="../../Reference.html#id9" title="J. Tinbergen. Economic Policy: Principles and Design. Contributions to economic analysis. North-Holland Publishing Company, 1967. URL: https://books.google.de/books?id=hA5gAAAAIAAJ.">1967</a>]</span></p>
<p>When solving a targeting problem it can be thought as follows: From the generic description of a model: <span class="math notranslate nohighlight">\(\textbf{y}_t= \textbf{F}(\textbf{x}_{t})\)</span>. Here <span class="math notranslate nohighlight">\(\textbf{x}_{t}\)</span> are all predetermined variables - lagged endogenous and all exogenous variables.</p>
<p>Think of a condensed model (<span class="math notranslate nohighlight">\(\textbf{G}\)</span>) with a few endogenous variables (<span class="math notranslate nohighlight">\(\bar{\textbf{y}}_t\)</span>):
the targets and a few exogenous variables(<span class="math notranslate nohighlight">\(\bar{\textbf{x}}_{t}\)</span>): the instrument variables. All the rest of the predetermined variables are fixed:<br />
<span class="math notranslate nohighlight">\(\bar{\textbf{y}}_t= \textbf{G}(\bar{\textbf{x}}_{t})\)</span></p>
<p>In some models the result depends on the level of exogenous variables with a lag. For instance in a disease spreading model, the <em>number of infected</em> on a day depends on the <em>probability of transmission</em> some days before. If the <em>probability of transmission</em> is the instrument and the <em>number of infected</em> is the target. Therefor it can be useful to allow a <strong>delay</strong>, when finding the instruments. In this case we want to look at  <span class="math notranslate nohighlight">\(\textbf{y}_t= \textbf{F}(\textbf{x}_{t-delay})\)</span></p>
<p>If we invert G we have a model where  instruments are functions of targets:
<span class="math notranslate nohighlight">\(\bar{\textbf{x}_{t-delay}}= \textbf{G}^{-1}(\bar{\textbf{y}_{t}})\)</span>. Then all we have to do is to find
<span class="math notranslate nohighlight">\(\textbf{G}^{-1}(\bar{\textbf{y}_{t}})\)</span></p>
<p>For most models <span class="math notranslate nohighlight">\(\bar{\textbf{x}}_{t-delay}= \textbf{G}^{-1}(\bar{\textbf{y}_{t}})\)</span> do not have a nice close form solution. However it can be solved numerically. We  turn to <strong>NewtonRaphson</strong> method.</p>
<p>So <span class="math notranslate nohighlight">\(\bar{\textbf{x}}_{t-delay}= \textbf{G}^{-1}(\bar{\textbf{y}_{t}^*})\)</span> will be found using :</p>
<p>for <span class="math notranslate nohighlight">\(k\)</span> = 1 to convergence</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\bar{\textbf{x}}_{t-delay,end}^k= \bar{\textbf{x}}_{t-delay,end}^{k-1}+ \textbf{J}^{-1}_t \times (\bar{\textbf{y}_{t}^*}-
\bar{\textbf{y}_{t}}^{k-1})\)</span></p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\bar{\textbf{y}}_t^{k}= \textbf{G}(\bar{\textbf{x}}_{t-delay}^{k})\)</span></p>
</div></blockquote>
<p>convergence: <span class="math notranslate nohighlight">\(\mid\bar{\textbf{y}_{t}^*}-
\bar{\textbf{y}_{t}}
\mid\leq \epsilon\)</span></p>
<p>Now we just need to find:</p>
<p><span class="math notranslate nohighlight">\(\textbf{J}_t = \frac{\partial \textbf{G} }{\partial \bar{\textbf{x}}_{t-delay}}\)</span></p>
<p>ModelFlow uses numerical differentiation, as it is quite simple and fast.</p>
<p><span class="math notranslate nohighlight">\(\textbf{J}_t \approx \frac{\Delta \textbf{G} }{\Delta \bar{\textbf{x}}_{t-delay}}\)</span></p>
<p>That means that we should run the model one time for each instrument, and record the
impact  on each of the targets from the , <span class="math notranslate nohighlight">\({\Delta {x}_{t-delay}^{instrument}}\)</span>then we have <span class="math notranslate nohighlight">\(\textbf{J}_t\)</span></p>
<p>In order for <span class="math notranslate nohighlight">\(\textbf{J}_t\)</span> to be invertible there has to be <strong>the same number of targets and instruments</strong>.</p>
<p>However, each instrument can be a basket of exogenous variable an they can have different impulse <span class="math notranslate nohighlight">\(\Delta\)</span>
.</p>
<div class="amsmath math notranslate nohighlight" id="equation-6ac06447-1d8b-432b-8842-3ccdba146326">
<span class="eqno">(7.1)<a class="headerlink" href="#equation-6ac06447-1d8b-432b-8842-3ccdba146326" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Delta x^{instrument=i} = 
\begin{bmatrix}
\Delta x^{instrument=i,variable=1} \\
\Delta x^{instrument=i,variable=2} \\
\Delta x^{instrument=i,variable=3} \\
\vdots \\
\Delta x^{instrument=i,variable=n} \\
\end{bmatrix}
\end{equation}\]</div>
<p>When a instrument changes the variables wil change and the change will be in the proportions defined by their impulse.</p>
<p>You will notice that the level of <span class="math notranslate nohighlight">\(\bar{\textbf{x}}\)</span> is updated (by  <span class="math notranslate nohighlight">\(\textbf{J}^{-1}_t \times (\bar{\textbf{y}_{t}^*}-
\bar{\textbf{y}_{t}}^{k-1})\)</span>) in all periods from <span class="math notranslate nohighlight">\(t-delay\)</span> to <span class="math notranslate nohighlight">\(end\)</span>, where <span class="math notranslate nohighlight">\(end\)</span> is the last timeframe in the dataframe. This is useful for many applications, where the instruments are level variable (i.e. not change variables). This is the default behavior. It can be changed.</p>
</section>
<section id="tuning-the-target-input-to-get-a-result">
<span id="index-10"></span><h2><span class="section-number">7.11. </span>Tuning the target input to get a result<a class="headerlink" href="#tuning-the-target-input-to-get-a-result" title="Permalink to this headline">#</a></h2>
<p>Models implemented in <code class="docutils literal notranslate"><span class="pre">modelflow</span></code> can be very different, and the targeting routine <code class="docutils literal notranslate"><span class="pre">.invert</span></code> is pretty general.
The user cant expect that targeting works out of the box. In most cases - as in this notebook - the options has to be set
to values which fits the problem at hand.</p>
<section id="impulse">
<span id="index-11"></span><h3><span class="section-number">7.11.1. </span>impulse<a class="headerlink" href="#impulse" title="Permalink to this headline">#</a></h3>
<p>The impulse has to be right. Else the jacobi matrix <span class="math notranslate nohighlight">\(\textbf{J}_t\)</span> will be useless. As discussed above - and forgetting the bar and the delay - the term  <span class="math notranslate nohighlight">\({\Delta \bar{\textbf{x}}_{t-delay}}\)</span>
is used when calculating the approximate</p>
<p>The size of impulse should not impact the result of the targeting function. However it can have major impact of the speed to convergence and the feasibility of the endeavor.</p>
<p>If a large impulse is used for a small variable <span class="math notranslate nohighlight">\(\textbf{x}+{\Delta \bar{\textbf{x}}_{t-delay}}\)</span>
may cause the model to become unsolvable. Or the model can be so nonlinear that the <span class="math notranslate nohighlight">\(\textbf{J}_t\)</span>
becomes irrelevant for the solution.</p>
<p>If a small impulse is used it can mean that <span class="math notranslate nohighlight">\(\textbf{J}_t\)</span>
becomes very small and <span class="math notranslate nohighlight">\(\textbf{J}^{-1}_t\)</span>
the problem becomes il conditioned (in other word the condition number  <span class="math notranslate nohighlight">\(\kappa(\textbf{J}_t)\)</span> should not be large)</p>
<p>As mentioned the impulse can set either when defining the instruments, or as a default impulse when the <code class="docutils literal notranslate"><span class="pre">.invert</span></code> routine is called (DefaultImpuls=).</p>
</section>
<section id="nonlinearity">
<span id="index-12"></span><h3><span class="section-number">7.11.2. </span>Nonlinearity<a class="headerlink" href="#nonlinearity" title="Permalink to this headline">#</a></h3>
<p>If the model is nonlinear it makes sense to update the jacobi matrix <span class="math notranslate nohighlight">\(\textbf{J}_t\)</span> frequently. Using <code class="docutils literal notranslate"><span class="pre">nonlin=a</span> <span class="pre">number</span></code> the user determines how many iterations the same jacobi matrix could be used before
a new one has to be calculated.</p>
<p>If:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nonlin=True</span></code> the jacobi will be updated every iteration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nonlin=False</span></code> the jacobi will not be updated (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nonlin=&lt;a</span> <span class="pre">number&gt;</span></code> the same jacobi matrix will be updated every <a number> iterations</p></li>
</ul>
</section>
<section id="convergence">
<span id="index-13"></span><h3><span class="section-number">7.11.3. </span>Convergence<a class="headerlink" href="#convergence" title="Permalink to this headline">#</a></h3>
<p>The targeting is stopped when all target variables converge. If the values of the target variables are large. The convergence criteria should reflect that. Else targeting will take really long time.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">defaultconv=&lt;a</span> <span class="pre">number&gt;</span></code></p></li>
</ul>
</section>
<section id="maximum-number-of-iterations">
<span id="index-14"></span><h3><span class="section-number">7.11.4. </span>Maximum number of iterations<a class="headerlink" href="#maximum-number-of-iterations" title="Permalink to this headline">#</a></h3>
<p>The max number of iterations are managed with</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">maxiter=&lt;a</span> <span class="pre">number&gt;</span></code></p></li>
</ul>
<p>If the problem is badly conditioned or the model very nonlinear it may take many iterations for Newthon-Raphson algorithm to converge.</p>
<p>Note this is not the number of iterations for the model to converge. This is the additional Newthon-Raphson  iterations.</p>
</section>
</section>
<section id="defining-instruments">
<h2><span class="section-number">7.12. </span>Defining Instruments<a class="headerlink" href="#defining-instruments" title="Permalink to this headline">#</a></h2>
<p>Then we have to provide the instruments. This is <strong>a list</strong>. This list has elements.</p>
<ul class="simple">
<li><p>Each element in the list is an instrument.</p></li>
<li><p>An element can be:</p>
<ul>
<li><p>a variable name</p></li>
<li><p>a tuple with a variable name  and the associated impulse <span class="math notranslate nohighlight">\(\Delta\)</span></p></li>
<li><p>a inner list which defines which contains:</p>
<ul>
<li><p>a list of variable names. Each element in the inner list is an instrument variable</p></li>
<li><p>a list of tupls each tuple contains a variable name and the associated impulse <span class="math notranslate nohighlight">\(\Delta\)</span>.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The <span class="math notranslate nohighlight">\(\Delta variable\)</span> is used in the numerical differentiation. Also if one instrument contains several variables, the proportion of each variable will be determined by the relative <span class="math notranslate nohighlight">\(\Delta  variable\)</span>.</p>
<p>To make this concrete below are some  examples:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Instrument definition</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>[ QO_J,TG]</p></td>
<td><p>Two instruments and each with one variable</p></td>
</tr>
<tr class="row-odd"><td><p>[ (QO_J,0.5), TG]</p></td>
<td><p>Same. QO_J is getting its own impulse (0.5)</p></td>
</tr>
<tr class="row-even"><td><p>[[ QO_J,QP_J], TG]</p></td>
<td><p>Two instruments the first have two  variables</p></td>
</tr>
<tr class="row-odd"><td><p>[[(QO_J,0.5),(ORLOV,1.)],(TG,0.01)]</p></td>
<td><p>Same. All variables get an impulse</p></td>
</tr>
</tbody>
</table>
</section>
<section id="advanced-information-targeting-class-instance">
<h2><span class="section-number">7.13. </span>Advanced information -  targeting class instance<a class="headerlink" href="#advanced-information-targeting-class-instance" title="Permalink to this headline">#</a></h2>
<p>When a model calls the <code class="docutils literal notranslate"><span class="pre">.invert</span></code> method a the modelinstance  will receive an object <code class="docutils literal notranslate"><span class="pre">.t_i</span></code>. This object has been doing the
underlying calculations. The very advanced/curious user can be interested in some of its properties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">=</span> <span class="n">mpak</span><span class="o">.</span><span class="n">t_i</span>
</pre></div>
</div>
</div>
</div>
<section id="instruments-a-list-if-instruments">
<h3><span class="section-number">7.13.1. </span><code class="docutils literal notranslate"><span class="pre">.instruments</span></code> a list if instruments<a class="headerlink" href="#instruments-a-list-if-instruments" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">instruments</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: {&#39;name&#39;: &#39;PAKGGREVCO2CER,PAKGGREVCO2GER,PAKGGREVCO2OER&#39;,
  &#39;vars&#39;: [(&#39;PAKGGREVCO2CER&#39;, 50),
   (&#39;PAKGGREVCO2GER&#39;, 25),
   (&#39;PAKGGREVCO2OER&#39;, 25)]},
 1: {&#39;name&#39;: &#39;PAKGGEXPGNFSCN_A&#39;, &#39;vars&#39;: [(&#39;PAKGGEXPGNFSCN_A&#39;, 20)]}}
</pre></div>
</div>
</div>
</div>
</section>
<section id="jac-the-jacobi-matrix">
<h3><span class="section-number">7.13.2. </span><code class="docutils literal notranslate"><span class="pre">.jac</span></code> The Jacobi matrix<a class="headerlink" href="#jac-the-jacobi-matrix" title="Permalink to this headline">#</a></h3>
<p>This property will contain the last calculated jacobi matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">jac</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAKGGREVCO2CER,PAKGGREVCO2GER,PAKGGREVCO2OER</th>
      <th>PAKGGEXPGNFSCN_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PAKCCEMISCO2TKN</th>
      <td>-21897.435926</td>
      <td>0.194735</td>
    </tr>
    <tr>
      <th>PAKGGBALOVRLCN</th>
      <td>60129.763443</td>
      <td>-17.735588</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="inv-the-inverted-jacobi-matrix">
<h3><span class="section-number">7.13.3. </span><code class="docutils literal notranslate"><span class="pre">.inv</span></code> The inverted Jacobi matrix<a class="headerlink" href="#inv-the-inverted-jacobi-matrix" title="Permalink to this headline">#</a></h3>
<p>This property will contain the last calculated jacobi matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAKCCEMISCO2TKN</th>
      <th>PAKGGBALOVRLCN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PAKGGREVCO2CER,PAKGGREVCO2GER,PAKGGREVCO2OER</th>
      <td>-0.000047</td>
      <td>-5.170117e-07</td>
    </tr>
    <tr>
      <th>PAKGGEXPGNFSCN_A</th>
      <td>-0.159642</td>
      <td>-5.813666e-02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And we can check if the this is really the inverted jacobi</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">jac</span> <span class="o">@</span> <span class="n">ti</span><span class="o">.</span><span class="n">inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAKCCEMISCO2TKN</th>
      <th>PAKGGBALOVRLCN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PAKCCEMISCO2TKN</th>
      <td>1.000000e+00</td>
      <td>-6.200011e-17</td>
    </tr>
    <tr>
      <th>PAKGGBALOVRLCN</th>
      <td>5.295483e-16</td>
      <td>1.000000e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="convergence-convergence-criteria">
<h3><span class="section-number">7.13.4. </span><code class="docutils literal notranslate"><span class="pre">.convergence</span></code> Convergence criteria<a class="headerlink" href="#convergence-convergence-criteria" title="Permalink to this headline">#</a></h3>
<p>This property will contain the last calculated jacobi matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">targetconv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;PAKCCEMISCO2TKN&#39;: 2000.0, &#39;PAKGGBALOVRLCN&#39;: 2000.0}
</pre></div>
</div>
</div>
</div>
</section>
<section id="targets-the-targets">
<h3><span class="section-number">7.13.5. </span><code class="docutils literal notranslate"><span class="pre">.targets</span></code> The targets<a class="headerlink" href="#targets-the-targets" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ti</span><span class="o">.</span><span class="n">targets</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PAKCCEMISCO2TKN</th>
      <th>PAKGGBALOVRLCN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024</th>
      <td>2.303703e+08</td>
      <td>-2.146245e+06</td>
    </tr>
    <tr>
      <th>2025</th>
      <td>2.315794e+08</td>
      <td>-2.279101e+06</td>
    </tr>
    <tr>
      <th>2026</th>
      <td>2.327948e+08</td>
      <td>-2.433659e+06</td>
    </tr>
    <tr>
      <th>2027</th>
      <td>2.340166e+08</td>
      <td>-2.610006e+06</td>
    </tr>
    <tr>
      <th>2028</th>
      <td>2.352449e+08</td>
      <td>-2.806904e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2096</th>
      <td>2.639583e+08</td>
      <td>-7.546307e+08</td>
    </tr>
    <tr>
      <th>2097</th>
      <td>2.639583e+08</td>
      <td>-8.227378e+08</td>
    </tr>
    <tr>
      <th>2098</th>
      <td>2.639583e+08</td>
      <td>-8.969610e+08</td>
    </tr>
    <tr>
      <th>2099</th>
      <td>2.639583e+08</td>
      <td>-9.778463e+08</td>
    </tr>
    <tr>
      <th>2100</th>
      <td>2.639583e+08</td>
      <td>-1.065989e+09</td>
    </tr>
  </tbody>
</table>
<p>77 rows  2 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="jacob-caculate-the-jacobi-matrix">
<h2><span class="section-number">7.14. </span>.jacob() Caculate the jacobi matrix<a class="headerlink" href="#jacob-caculate-the-jacobi-matrix" title="Permalink to this headline">#</a></h2>
<p>This method can calculate the Jacobi matrix in any year. below find the Jacobi in the start and the end of the simulation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show2025</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">show2025</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">float_format</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 PAKGGREVCO2CER,PAKGGREVCO2GER,PAKGGREVCO2OER  PAKGGEXPGNFSCN_A
PAKCCEMISCO2TKN                                  -41734795.86             76.43
PAKGGBALOVRLCN                                      138194.79            -18.78
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show2100</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">2100</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">show2100</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">float_format</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 PAKGGREVCO2CER,PAKGGREVCO2GER,PAKGGREVCO2OER  PAKGGEXPGNFSCN_A
PAKCCEMISCO2TKN                                     -19630.16              0.20
PAKGGBALOVRLCN                                       59925.97            -17.56
</pre></div>
</div>
</div>
</div>
<p>Not surprising - considered the expansion of the economy  - the impact of the impulse is quite smaller in the  last year than in the first. This also explains why it takes many iterations for the
targeting to converge in the later years.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content\07_MoreFeatures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../05_WBModels/MoreComplexScenarios.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>More complex scenarios</p>
      </div>
    </a>
    <a class="right-next"
       href="../06_ModelAnalytics/ModelStructure.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Model analytics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preparing-the-work-space">7.1. Preparing the work space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-a-model-data-and-descriptions">7.2. Load a  model, data and descriptions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-the-model-to-create-a-baseline">7.3. Solve the model to create a baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-co2-emission-a-very-simple-example">7.4. Target CO2 emission - a  very simple example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-targets">7.4.1. Define targets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-instruments">7.4.2. Define instruments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-instruments">7.4.3. Find the instruments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display-result">7.4.4. Display result</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#targeting-carbon-emissions-in-a-budget-neutral-manner">7.5. Targeting carbon emissions in a budget neutral manner</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#target-co2-emission-and-government-deficit-by-adjusting-carbon-tax-and-government-expenditure">7.6. Target CO2 emission and government deficit by adjusting carbon tax and government expenditure.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-target-trajectory-for-co2-emission">7.6.1. Define target trajectory for CO2 emission.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dataframe-with-the-target-emission">7.6.2. Create a dataframe with the target emission</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-target-for-government-deficit">7.6.3. Create target for government deficit</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.7. Define instruments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#now-solve-the-problem">7.8. Now solve the problem:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-charts-of-emission-deficit-and-target-variables">7.8.1. Make charts of emission, deficit and target variables.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weighting-the-instruments">7.9. Weighting the instruments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#targeting-background">7.10. Targeting background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tuning-the-target-input-to-get-a-result">7.11. Tuning the target input to get a result</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse">7.11.1. impulse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinearity">7.11.2. Nonlinearity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence">7.11.3. Convergence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-number-of-iterations">7.11.4. Maximum number of iterations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-instruments">7.12. Defining Instruments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-information-targeting-class-instance">7.13. Advanced information -  targeting class instance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#instruments-a-list-if-instruments">7.13.1. <code class="docutils literal notranslate"><span class="pre">.instruments</span></code> a list if instruments</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jac-the-jacobi-matrix">7.13.2. <code class="docutils literal notranslate"><span class="pre">.jac</span></code> The Jacobi matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inv-the-inverted-jacobi-matrix">7.13.3. <code class="docutils literal notranslate"><span class="pre">.inv</span></code> The inverted Jacobi matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence-convergence-criteria">7.13.4. <code class="docutils literal notranslate"><span class="pre">.convergence</span></code> Convergence criteria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#targets-the-targets">7.13.5. <code class="docutils literal notranslate"><span class="pre">.targets</span></code> The targets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jacob-caculate-the-jacobi-matrix">7.14. .jacob() Caculate the jacobi matrix</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrew Burns and Ib Hansen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright World Bank. 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>