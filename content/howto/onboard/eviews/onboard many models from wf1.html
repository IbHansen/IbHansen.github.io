
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Onboard all models defined in .wf1 files &#8212; ModelFlow</title>
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Normalizing when onboarding eviews models" href="Normalizing%20when%20onboarding%20eviews.html" />
    <link rel="prev" title="Onboard a model defined in a .wf1 file" href="onboard%20one%20model%20from%20%20wf1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ModelFlow</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model, solutions and Modelflow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notebooks/intro/model%20and%20solution.html">
   What is a Model in ModelFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notebooks/intro/Example%20Solow.html">
   Example Solow model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python and pandas stuff
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Python/Intro_Jupyter_notebook.html">
   Introduction to the Jupyter Notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notebooks/pandas/dataframes.html">
   Introduction to Pandas dataframes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Updating variables
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../update/model%20update.html">
   Update, modifying series in a dataframe using modelflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../update/extending_dataframes.html">
   Extend Pandas dataframes with ModelFLow capabilities.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Simulate models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../update/create_experiment.html">
   Create an experiment, simulate it and access results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../update/create_save_scenarios.html">
   Create many scenarios, simulate them  and access results
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fixing the value of designated variables.
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../update/Fixing%20variables.html">
   Fixing the value of variables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Features
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../Python/modelflow_features.html">
   Useful model instance properties and methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Structure
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../structure/Logical_structure.html">
   Logical structure and dependencies.
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Onboarding
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../notebooks/intro/model%20specification.html">
   Specification of models (introduction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onboard%20one%20model%20from%20%20wf1.html">
   Onboard a model defined in a .wf1 file
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Onboard all models  defined in .wf1 files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Normalizing%20when%20onboarding%20eviews.html">
   Normalizing when onboarding  eviews models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Attribution
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../attribution/Attribution%20background.html">
   Attribution
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../optimization/Optimize_simpel.html">
   Mean variance optimization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../litterature.html">
   Litterature
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Jupyter book test
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../booktest.html">
   Test of Jupyter book features.
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../../_sources/content/howto/onboard/eviews/onboard many models from wf1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcontent/howto/onboard/eviews/onboard many models from wf1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/content/howto/onboard/eviews/onboard many models from wf1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#list-potential-files">
   List potential files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-specific-transformations">
   Model specific transformations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transform-all-wf1-files-in-the-folder">
   Transform all wf1 files in the folder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-all-the-models">
   Check all the models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-models">
   Run the models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-names-in-the-namespace">
   Make some names in the namespace
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Onboard all models  defined in .wf1 files</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#list-potential-files">
   List potential files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-specific-transformations">
   Model specific transformations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transform-all-wf1-files-in-the-folder">
   Transform all wf1 files in the folder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-all-the-models">
   Check all the models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-models">
   Run the models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-names-in-the-namespace">
   Make some names in the namespace
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="onboard-all-models-defined-in-wf1-files">
<h1>Onboard all models  defined in .wf1 files<a class="headerlink" href="#onboard-all-models-defined-in-wf1-files" title="Permalink to this headline">¶</a></h1>
<p>This notebook takes all .wf1 workfile from the folder wfs\ and transform the models  it to a modelflow model.<br></p>
<p>The overall process is performed in a Dataclass named:<strong>GrapWfModel</strong><br>
Close study of this class can be rewarding, but is outside the need of most users.<br>
The overall structure is:</p>
<ol class="simple">
<li><p>Eviews is started and the wf1 file is loaded</p></li>
<li><ol class="simple">
<li><p>Some transformations are performed on data.</p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>The model is unlinked</p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>The workspace is saved as a wf2 file. Same name with <code class="docutils literal notranslate"><span class="pre">_modelflow</span> <span class="pre">appended</span></code></p></li>
</ol>
</li>
<li><p>Eviews is closed</p></li>
<li><p>The wf2 file is read as a json file.</p></li>
<li><p>Relevant objects are extracted.</p></li>
<li><p>The MFMSA variable is  extracted, to be saved in the dumpfile.</p></li>
<li><p>The equations are transformed and normalized to modelflow format and classified into identities and stochastic</p></li>
<li><p>Stochastic equations are enriched by add_factor and fixing terms (dummy + fixing value)</p></li>
<li><p>For Stochastic equations new fitted variables are generated - without add add_factors and dummies.</p></li>
<li><p>A model to generate fitted variables is created</p></li>
<li><p>A model to generate add_factors is created.</p></li>
<li><p>A model encompassing the original equations, the model for fitted variables and for add_factors is created.</p></li>
<li><p>The data series and scalars are shoveled into a Pandas dataframe</p></li>
<li><ol class="simple">
<li><p>Some special series are generated as the expression can not be incorporated into modelflow model specifications</p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>The model for fitted values is simulated in the specified timespan</p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>The model for add_factors is simulated in the timespan set in MFMSA</p></li>
</ol>
</li>
<li><p>The data descriptions are extracted into a dictionary.</p></li>
<li><ol class="simple">
<li><p>Data descriptions for dummies, fixed values, fitted values and add_factors are derived.</p></li>
</ol>
</li>
<li><p>Now we have a model and a dataframe with all variables which are needed.
b
The GrapWfModel instance in general keeps most of the steps so the developer can inspect the the different steps.</p></li>
</ol>
<ul class="simple">
<li><p>Eviews has to be installed</p></li>
<li><p>pyevies has to be installed</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">modelclass</span> <span class="kn">import</span> <span class="n">model</span> 
<span class="kn">from</span> <span class="nn">modelgrabwf2</span> <span class="kn">import</span> <span class="n">GrabWfModel</span>
<span class="n">model</span><span class="o">.</span><span class="n">widescreen</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">scroll_off</span><span class="p">()</span>
<span class="n">latex</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    div#notebook-container    { width: 95%; }
    div#menubar-container     { width: 65%; }
    div#maintoolbar-container { width: 99%; }
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="o">%</span><span class="k">load_ext</span> autoreload
 <span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="section" id="list-potential-files">
<h2>List potential files<a class="headerlink" href="#list-potential-files" title="Permalink to this headline">¶</a></h2>
<p>The workfiles are located in the <code class="docutils literal notranslate"><span class="pre">wfs</span></code> folder. <br>
The <a class="reference external" href="https://docs.python.org/3/library/pathlib.html">pathlib.Path</a> class is used to find all wf1 files</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filedict</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="o">.</span><span class="n">stem</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;wfs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.wf1&#39;</span><span class="p">)}</span>
<span class="k">for</span> <span class="n">modelname</span><span class="p">,</span><span class="n">filename</span> <span class="ow">in</span> <span class="n">filedict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The model and date for </span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1"> is located in this workfile:</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The model and date for ago is located in this workfile:wfs\agosoln.wf1
The model and date for mda is located in this workfile:wfs\MDAsoln.wf1
The model and date for pak is located in this workfile:wfs\PAKSoln.wf1
The model and date for per is located in this workfile:wfs\PERMOD_damage_asFactor20220322.wf1
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model-specific-transformations">
<h2>Model specific transformations<a class="headerlink" href="#model-specific-transformations" title="Permalink to this headline">¶</a></h2>
<p>Not all Eviews equations has a direct counterpart in modelflow.<br>
To handle that two types of transformations can be provided for a specific model.</p>
<ul class="simple">
<li><p><strong>eviews_run_lines</strong> which specifies a list of Eviews command lines to be run. Typical to make some transformation of data.</p></li>
<li><p><strong>country_trans</strong> which specifies a list of replacements to be done to the Eviews formulas before they are processed.</p></li>
</ul>
<p>As a convention the variables like this &lt;modelname&gt;_eviews_run_lines and <modelname>_trans</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pak_trans</span> <span class="o">=</span> <span class="k">lambda</span> <span class="nb">input</span> <span class="p">:</span> <span class="nb">input</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;- 01*D(&#39;</span><span class="p">,</span><span class="s1">&#39;-1*D(&#39;</span><span class="p">)</span>   

<span class="n">ago_trans</span> <span class="o">=</span> <span class="k">lambda</span>  <span class="nb">input</span> <span class="p">:</span> <span class="nb">input</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;@MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,&quot;2000 2020&quot;)&#39;</span><span class="p">,</span><span class="s1">&#39;MEAN_AGOBNCABFUNDCD_DIV_AGONYGDPMKTPCD&#39;</span><span class="p">)</span> 
<span class="n">ago_eviews_run_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;smpl @ALL&#39;</span><span class="p">,</span><span class="s1">&#39;series MEAN_AGOBNCABFUNDCD_DIV_AGONYGDPMKTPCD = @MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,&quot;2000 2020&quot;)&#39;</span><span class="p">]</span>

<span class="n">mda_trans</span> <span class="o">=</span> <span class="k">lambda</span> <span class="nb">input</span><span class="p">:</span> <span class="nb">input</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_MDAsbbrev.@coef(2)&#39;</span><span class="p">,</span><span class="s1">&#39;_MDASBBREV_at_COEF_2&#39;</span><span class="p">)</span>         
<span class="n">mda_eviews_run_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Scalar _MDASBBREV_at_COEF_2 = _MDASBBREV.@COEF(+2)&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transform-all-wf1-files-in-the-folder">
<h2>Transform all wf1 files in the folder<a class="headerlink" href="#transform-all-wf1-files-in-the-folder" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">allmodels</span> <span class="o">=</span> <span class="p">{</span><span class="n">modelname</span><span class="p">:</span> 
     <span class="n">GrabWfModel</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> 
                        <span class="n">eviews_run_lines</span><span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1">_eviews_run_lines&#39;</span><span class="p">,[]),</span>
                        <span class="n">country_trans</span>    <span class="o">=</span>   <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1">_trans&#39;</span>   <span class="p">,</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[:]),</span>
                        <span class="n">make_fitted</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>        <span class="c1"># make equatios for fitted values of stocastic equations </span>
                        <span class="n">do_add_factor_calc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>   <span class="c1"># Calculate the add factors which makes the stocastic equations match    </span>
                        <span class="n">fit_start</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span>          <span class="c1"># Start of calculation of fittet model in baseline (to have some historic values) </span>
                        <span class="n">fit_end</span>   <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>           <span class="c1"># end of calc for fittted model, if None taken from mdmfsa options  </span>
                        <span class="n">disable_progress</span> <span class="o">=</span><span class="kc">True</span>
                        <span class="p">)</span> 
                  <span class="k">for</span> <span class="n">modelname</span><span class="p">,</span><span class="n">filename</span> <span class="ow">in</span> <span class="n">filedict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading c:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\wfs\agosoln.wf1
Assummed model name: AGO
Eviewsline to run :smpl @ALL
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Eviewsline to run :series MEAN_AGOBNCABFUNDCD_DIV_AGONYGDPMKTPCD = @MEAN(AGOBNCABFUNDCD/AGONYGDPMKTPCD,&quot;2000 2020&quot;)
The model: AGO is unlinked 
Writing C:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\wfs\agosoln_modelflow.wf2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model name: AGO
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing the model:AGO
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>testmodel calculated  
Calculation of add factors for AGO calculated  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading c:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\wfs\MDAsoln.wf1
Assummed model name: MDA
Eviewsline to run :Scalar _MDASBBREV_at_COEF_2 = _MDASBBREV.@COEF(+2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The model: MDA is unlinked 
Writing C:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\wfs\MDAsoln_modelflow.wf2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model name: MDA
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing the model:MDA
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>testmodel calculated  
Calculation of add factors for MDA calculated  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading c:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\wfs\PAKSoln.wf1
Assummed model name: PAK
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The model: PAK is unlinked 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing C:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\wfs\PAKSoln_modelflow.wf2
Model name: PAK
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing the model:PAK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-all-the-models">
<h2>Check all the models<a class="headerlink" href="#check-all-the-models" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">modelname</span><span class="p">,</span><span class="n">cmodel</span> <span class="ow">in</span> <span class="n">allmodels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">cmodel</span><span class="o">.</span><span class="n">test_model</span><span class="p">(</span><span class="n">cmodel</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">cmodel</span><span class="o">.</span><span class="n">end</span><span class="p">,</span><span class="n">maxerr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">showall</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># tol determins the max acceptable absolute difference </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AGO calculated  

Chekking residuals for AGO 2016 to 2060

Variable with residuals above threshold
AGONECONPRVTCN                        , Max difference:  2861.03139496 Max Pct    0.0000106457% It is number    45 in the solveorder and error number 1
AGONEGDIFGOVCN                        , Max difference:    21.01837921 Max Pct    0.0000013130% It is number    56 in the solveorder and error number 2
AGONEGDIFTOTCN                        , Max difference:   177.46922302 Max Pct    0.0000007316% It is number    59 in the solveorder and error number 3
AGONEEXPNOILCN                        , Max difference:    34.74809837 Max Pct    0.0000022911% It is number    65 in the solveorder and error number 4
AGONEEXPGOILCN                        , Max difference:   544.94689941 Max Pct    0.0000026926% It is number    68 in the solveorder and error number 5
AGONEEXPGNFSCN                        , Max difference:   504.25928497 Max Pct    0.0000023486% It is number    69 in the solveorder and error number 6
AGONEIMPGNFSCN                        , Max difference:  1101.58077240 Max Pct    0.0000111348% It is number    73 in the solveorder and error number 7
AGONYYWBTOTLCN                        , Max difference:   286.10862160 Max Pct    0.0000091250% It is number    82 in the solveorder and error number 8
AGOGGREVTOTLCN                        , Max difference:   136.30834198 Max Pct    0.0000014056% It is number    83 in the solveorder and error number 9
AGOGGEXPINTPCN                        , Max difference:    99.77352953 Max Pct    0.0000082146% It is number    88 in the solveorder and error number 10
AGONVGDPFCSTCN                        , Max difference:   455.67959595 Max Pct    0.0000009309% It is number   113 in the solveorder and error number 11
AGONYTAXNINDKN                        , Max difference:     1.37211440 Max Pct    0.0014202837% It is number   115 in the solveorder and error number 12
AGONVAGRTOTLCN                        , Max difference:     5.06173030 Max Pct    0.0000057479% It is number   116 in the solveorder and error number 13
AGONVINDMINGCN                        , Max difference:    89.14881706 Max Pct    0.0000037522% It is number   117 in the solveorder and error number 14
AGONVSRVPUBLCN                        , Max difference:   597.87203789 Max Pct    0.0000183998% It is number   118 in the solveorder and error number 15
AGONVGDPOTHRCN                        , Max difference:   355.96192932 Max Pct    0.0000005341% It is number   119 in the solveorder and error number 16
AGONYGDPMKTPCN                        , Max difference:   296.17025757 Max Pct    0.0000012217% It is number   167 in the solveorder and error number 17
MDA calculated  

Chekking residuals for MDA 2014 to 2025
PAK calculated  

Chekking residuals for PAK 2015 to 2100

Variable with residuals above threshold
PAKNYYWBTOTLCN              , Max difference:    76.62465858 Max Pct    0.0000042560% It is number    62 in the solveorder and error number 1
PAKNECONPRVTCN              , Max difference:    35.41133165 Max Pct    0.0000017794% It is number    73 in the solveorder and error number 2
PER calculated  

Chekking residuals for PER 2016 to 2300
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-the-models">
<h2>Run the models<a class="headerlink" href="#run-the-models" title="Permalink to this headline">¶</a></h2>
<p>Some models need a different alfa (dampening factor in Gauss iterations) in order to solve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alfadict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ago&#39;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">modelname</span><span class="p">,</span><span class="n">cmodel</span> <span class="ow">in</span> <span class="n">allmodels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">cmodel</span><span class="o">.</span><span class="n">mmodel</span><span class="p">(</span><span class="n">cmodel</span><span class="o">.</span><span class="n">base_input</span><span class="p">,</span><span class="n">alfa</span><span class="o">=</span><span class="n">alfadict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">modelname</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
    <span class="n">cmodel</span><span class="o">.</span><span class="n">mmodel</span><span class="o">.</span><span class="n">modeldump</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;modelflowdumps/</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1"> run and saved&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ago run and saved
mda run and saved
pak run and saved
per run and saved
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!dir modelflowdumps\
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Volume in drive C has no label.
 Volume Serial Number is C2DB-095E

 Directory of c:\wb new\Modelflow\working_paper\thebook\content\howto\onboard\eviews\modelflowdumps

20-04-2022  14:20    &lt;DIR&gt;          .
14-05-2022  23:43    &lt;DIR&gt;          ..
14-05-2022  23:45         1.434.250 ago
14-05-2022  23:45         1.029.618 mda
14-05-2022  23:45         3.386.584 pak
14-05-2022  23:45        11.979.848 per
               4 File(s)     17.830.300 bytes
               2 Dir(s)  795.074.887.680 bytes free
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-names-in-the-namespace">
<h2>Make some names in the namespace<a class="headerlink" href="#make-some-names-in-the-namespace" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">modelname</span><span class="p">,</span><span class="n">cmodel</span> <span class="ow">in</span> <span class="n">allmodels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">thismodel</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;m</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">thisbaseline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1">_baseline&#39;</span>
    <span class="n">thiscmodel</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">modelname</span><span class="si">}</span><span class="s1">_cmodel&#39;</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="n">thismodel</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmodel</span><span class="o">.</span><span class="n">mmodel</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="n">thisbaseline</span><span class="p">]</span><span class="o">=</span> <span class="n">cmodel</span><span class="o">.</span><span class="n">base_input</span> 
    <span class="nb">globals</span><span class="p">()[</span><span class="n">thiscmodel</span><span class="p">]</span><span class="o">=</span> <span class="n">cmodel</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">thismodel</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">thisbaseline</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="n">thiscmodel</span><span class="si">}</span><span class="s1"> has been created&#39;</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mago, ago_baseline and ago_cmodel has been created
mmda, mda_baseline and mda_cmodel has been created
mpak, pak_baseline and pak_cmodel has been created
mper, per_baseline and per_cmodel has been created
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">thissilent</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mago</span><span class="p">(</span><span class="n">ago_baseline</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="n">thissilent</span><span class="p">,</span><span class="n">alfa</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mmda</span><span class="p">(</span><span class="n">mda_baseline</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="n">thissilent</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mpak</span><span class="p">(</span><span class="n">pak_baseline</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="n">thissilent</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mper</span><span class="p">(</span><span class="n">per_baseline</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="n">thissilent</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content\howto\onboard\eviews"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="onboard%20one%20model%20from%20%20wf1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Onboard a model defined in a .wf1 file</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Normalizing%20when%20onboarding%20eviews.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Normalizing when onboarding  eviews models</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Ib Hansen<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>